<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>无纸化集中业务管理系统</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<script src="/static/js/ocx/attach.js" type="text/javascript"></script>

		@@include('url-config.html')
	</head>
	<body class="bg-info">

		<div class="layui-card layui-card-form">

			<div class="layui-card-body">

				<form class="ag-form layui-form" ag-data-ctx="cfgmgr" ag-data-url="/cfg/modelFile/addFieldInit" ag-data-index="1">



						<div class="layui-inline ">
							<label class="layui-form-label">模版元素：</label>
							<div class="layui-input-block">
								<select id="modelement_code" name="modelement">
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">区域类型：</label>
							<div class="layui-input-block">
								<select name="TYPE" id="TYPE">
									<option value="2">
										手写区域
									</option>
									<option value="3" selected>
										编辑区域
									</option>
									<option value="5">
										手写映射区域
									</option>
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">是否编辑：</label>
							<div class="layui-input-block">
								<select name="EDIT_TYPE" id="EDIT_TYPE">
									<option value="3" selected>
										不可编辑
									</option>
									<option value="0">
										可编辑
									</option>
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">边框样式：</label>
							<div class="layui-input-block">
								<select name="BORDER" id="BORDER">
									<option value="0" selected>
										无边框
									</option>
									<option value="1">
										3D边框
									</option>
									<option value="2">
										实线边框
									</option>
									<option value="3">
										下滑下边框
									</option>
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">文字水平对齐方式：</label>
							<div class="layui-input-block">
								<select name="HALIGN" id="HALIGN">
									<option value="0" selected>
										左对齐
									</option>
									<option value="1">
										居中对齐
									</option>
									<option value="2">
										右对齐
									</option>
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">文字垂直对齐方式：</label>
							<div class="layui-input-block">
								<select name="VALIGN" id="VALIGN">
									<option value="0">
										上对齐
									</option>
									<option value="1" selected>
										纵居中
									</option>
									<option value="2">
										下对齐
									</option>
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">行间距：</label>
							<div class="layui-input-block">
								<select name="ROWKERNING" id="ROWKERNING">
									<option value="0" selected>0</option>
									<option value="2">2</option>
									<option value="4">4</option>
									<option value="6">6</option>
									<option value="8">8</option>
									<option value="10">10</option>
									<option value="12">12</option>
									<option value="14">14</option>
								</select>
							</div>
						</div>

						<div class="layui-inline ">
							<label class="layui-form-label">字体：</label>
							<div class="layui-input-block">
								<input type="hidden" name="FONT_FAMILY" id="FONT_FAMILY" value="宋体">
								<a id="font_family_link" href="javascript:;" hidefocus="true" onclick="showMenu(this.id)" style="font-family: 宋体"><span>宋体</span></a>
							</div>
						</div>
						<div class="layui-inline ">
							<label class="layui-form-label">字号：</label>
							<div class="layui-input-block">
								<input type="hidden" name="FONT_SIZE" id="FONT_SIZE" value="12pt">
								<a id="font_size_link" href="javascript:;" hidefocus="true" class="dropdown" onclick="showMenu(this.id, 1);"><span>小四</span></a>
							</div>
						</div>



						<div class="layui-inline ">
							<label class="layui-form-label">字体颜色：</label>
							<div class="layui-input-block">
								<input type="hidden" name="FONT_COLOR" id="FONT_COLOR" value="#000000">
								<a id="font_color_link" href="javascript:;" hidefocus="true" class="dropdown" onclick="showMenu(this.id, 1);"
								 style="color:#000000"><span>文字颜色</span></a>
							</div>
						</div>


				</form>


			</div>

			<div class="layui-card-footer">

				<button class="ag-btn-save layui-btn layui-btn-sm layui-btn-normal " ag-data-ctx="cfgmgr" onclick="add1();"
				 ag-data-index="1">
					<i class="layui-icon layui-icon-ok-circle "></i>
					<span class="btn-span-middle">提交</span>
				</button>
				<button class="ag-btn-cancel layui-btn layui-btn-sm layui-btn-normal">
					<i class="layui-icon layui-icon-close "></i>
					<span class="btn-span-middle">取消</span>
				</button>
			</div>

		</div>




		<div id="font_family_link_menu" style="font-size: 14px;" style="display: none">
			<li>
				<a href="javascript:set_font_family('宋体');" style="font-family: 宋体;">宋体<span style="font-family:Webdings">6</span></a>
			</li>
			<li>
				<a href="javascript:set_font_family('黑体');" style="font-family: 黑体;">黑体<span style="font-family:Webdings">6</span></a>
			</li>
			<li>
				<a href="javascript:set_font_family('楷体');" style="font-family: 楷体;">楷体<span style="font-family:Webdings">6</span></a>
			</li>
			<li>
				<a href="javascript:set_font_family('隶书');" style="font-family: 隶书;">隶书<span style="font-family:Webdings">6</span></a>
			</li>
			<li>
				<a href="javascript:set_font_family('幼圆');" style="font-family: 幼圆;">幼圆<span style="font-family:Webdings">6</span></a>
			</li>
			<li>
				<a href="javascript:set_font_family('Arial');" style="font-family: Arial;">Arial</a>
			</li>
			<li>
				<a href="javascript:set_font_family('Fixedsys');" style="font-family: Fixedsys;">Fixedsys</a>
			</li>
		</div>
		<div id="font_size_link_menu" style="display: none">
			<li>
				<a href="javascript:set_font_size('8pt', '小五');">小五<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('10pt', '五号');">五号<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('12pt', '小四');">小四<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('14pt', '四号');">四号<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('15pt', '小三');">小三<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('16pt', '三号');">三号<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('18pt', '小二');">小二<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('22pt', '二号');">二号<span style="font_sizey:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('24pt', '小一');">小一<span style="font_size:Webdings">8</span></a>
			</li>
			<li>
				<a href="javascript:set_font_size('26pt', '一号');">一号<span style="font_size:Webdings">8</span></a>
			</li>
		</div>
		<div id="font_color_link_menu" style="display: none;">
		</div>

	</body>

	<script>
		layui.use('form', function() {

			var form = layui.form;

			form.render();

		});
	</script>





</html>
<script>
	document.all('font_color_link_menu').innerHTML = LoadForeColorTable('set_font_color');

	function LoadForeColorTable(ClickFunc) {
		var tColor = "";
		var tRowNum = 8;
		var tColorAry = new Array();
		tColorAry[0] = "#000000";
		tColorAry[1] = "#993300";
		tColorAry[2] = "#333300";
		tColorAry[3] = "#003300";
		tColorAry[4] = "#003366";
		tColorAry[5] = "#000080";
		tColorAry[6] = "#333399";
		tColorAry[7] = "#333333";

		tColorAry[8] = "#800000";
		tColorAry[9] = "#FF6600";
		tColorAry[10] = "#808000";
		tColorAry[11] = "#008000";
		tColorAry[12] = "#008080";
		tColorAry[13] = "#0000FF";
		tColorAry[14] = "#666699";
		tColorAry[15] = "#808080";

		tColorAry[16] = "#FF0000";
		tColorAry[17] = "#FF9900";
		tColorAry[18] = "#99CC00";
		tColorAry[19] = "#339966";
		tColorAry[20] = "#33CCCC";
		tColorAry[21] = "#3366FF";
		tColorAry[22] = "#800080";
		tColorAry[23] = "#999999";

		tColorAry[24] = "#FF00FF";
		tColorAry[25] = "#FFCC00";
		tColorAry[26] = "#FFFF00";
		tColorAry[27] = "#00FF00";
		tColorAry[28] = "#00FFFF";
		tColorAry[29] = "#00CCFF";
		tColorAry[30] = "#993366";
		tColorAry[31] = "#CCCCCC";

		tColorAry[32] = "#FF99CC";
		tColorAry[33] = "#FFCC99";
		tColorAry[34] = "#FFFF99";
		tColorAry[35] = "#CCFFCC";
		tColorAry[36] = "#CCFFFF";
		tColorAry[37] = "#99CCFF";
		tColorAry[38] = "#CC99FF";
		tColorAry[39] = "#FFFFFF";

		var tColorTableHTML = '<table cellpadding="0" cellspacing="0" class="ColorTable">';
		tColorTableHTML += '  <tr>';
		for (var ti = 0; ti < tColorAry.length; ti++) {
			tColorTableHTML += '    <td onmouseover="this.className=\'Selected\';" onmouseout="this.className=\'\';" onclick="' +
				ClickFunc + '(\'' + tColorAry[ti] + '\');"';
			if (tColor.toUpperCase() == tColorAry[ti])
				tColorTableHTML += ' class="Selected"';
			tColorTableHTML += '><div style="width:11px;height:11px;background-color:' + tColorAry[ti] + ';"></div></td>';
			if ((ti + 1) % tRowNum == 0 && ti + 1 != tColorAry.length) {
				tColorTableHTML += '  </tr>';
				tColorTableHTML += '  <tr>';
			};
		};
		tColorTableHTML += '  </tr>';
		tColorTableHTML += '</table>';

		return tColorTableHTML;
	}

	function set_font_family(family) {
		document.all("FONT_FAMILY").value = family;
		document.all('font_family_link').innerHTML = "<span>" + (family == "" ? "字体" : family) + "</span>";
		hideMenu();
	}

	function set_font_size(size, text) {
		document.all("FONT_SIZE").value = size;
		document.all('font_size_link').innerHTML = "<span>" + text + "</span>";
		hideMenu();
	}

	function set_font_color(color) {
		document.all("FONT_COLOR").value = color;
		document.all('font_color_link').style.color = color;
		hideMenu();
	}

	function add1() {

		if (confirm("您确认要修改？")) {

			var modelement_code = document.all("modelement_code").value;
			var type = document.all("TYPE").value;
			var border = document.all("BORDER").value;
			var halign = document.all("HALIGN").value;
			var valign = document.all("VALIGN").value;
			var font_family = document.all("FONT_FAMILY").value;
			var font_size = document.all("FONT_SIZE").value;
			var font_color = document.all("FONT_COLOR").value;
			var edit_type = document.all("EDIT_TYPE").value;
			var rowkerning = document.all("ROWKERNING").value; //行间距需要优化
			parent.modelFileEdit(modelement_code, type, border, halign, valign, font_family, font_size, font_color, edit_type,
				rowkerning);
			// window.close();
			util.closeWin();
		}
	}

	$(function() {
		$('#font_family_link_menu').hide();
	});
</script>
